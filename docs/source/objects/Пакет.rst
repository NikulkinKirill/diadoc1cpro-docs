
Структура "Пакет"
=================

На текущий момент доступно 2 версии структуры:

-  :ref:`Пакет_4.0`

-  :ref:`Пакет_до_4.0`

.. _Пакет_4.0:

Пакет (начиная с версии 4.0)
----------------------------

Пакет - структура, содержащая сведения о пакете документов. На текущий момент такая структура используется внутри модуля. В подключаемом модуле приходит дополненным до предыдущей версии структуры.

*Элементы:*

* **Направление** (тип Строка) - принимает значение "Исходящее" / "Входящее"
* **ДокументУчета** - ссылка на документ в 1С, который является основанием для данного пакета
* **Состояние** (тип Строка) - принимает значение "Подготовлен" / "Отправлен" / "ЗагруженИзДиадок" / "Получен" / "Переотправлен"
* **Заблокирован** (тип Булево) - признак того, что пакет заблокированный. В таком пакете любая операция применяется ко всем документам сразу
* **ИдентификаторВида** (тип Строка) - ID пакета из события :doc:`ПолучитьТаблицуИспользуемыхПакетов <../func/pm/Poluchit'TablitsuIspol'zuyemykhPaketov>`
* **ДатаЭДО** (тип Дата) - дата создания пакета
* **Шаблон** (тип Булево) - признак того, что это пакет-шаблон
* **Реквизиты** (тип Структура) - структура основных реквизитов. Для исходящих: реквизиты документа-основания пакета. Для входящих: реквизиты первого полученного документа пакета
* **ДопРеквизиты** (тип Структура) - структура дополнительных данных любого типа, которые могут быть использованы в событие :doc:`ПодготовкиПакета <../func/pm/Podgotovit'Paket>` и после. Допустимо использование не более 5 реквизитов
* **Идентификаторы** (тип Структура) - структура идентификаторов на сервере Диадока, характеризующих пакет
* **ПараметрыШаблона** (тип Структура) - структура идентификаторы на сервере Диадока, характеризующих пакет-шаблон
* **Отправитель** (тип Структура) - структура, описывающая участника ЭДО, от которого был отправлен пакет
* **Получатель** (тип Структура) - структура, описывающая участника ЭДО, который получил пакет
* **Документы** (тип Массив) - массив структур документов, входящих в состав пакета
* **СлужебнаяИнформация** (тип Структура) - вспомогательная структура, содержащая временные переменные

Структура **Реквизиты**:

* **Дата** - дата документа-основания исходящего пакета / дата первого документа входящего пакета
* **Номер** - номер документа-основания исходящего пакета / номер первого документа входящего пакета
* **Сумма** - сумма документа-основания исходящего пакета / сумма первого документа входящего пакета

Структура **Идентификаторы**:

* **BoxId** - идентификатор ящика организации
* **LetterId** - идентификатор пакета Диадока в ящике организации
* **ПакетЭДО** - ссылка на описание электронного пакета в базе 1С

Структура **ПараметрыШаблона**:

* **MessageFromBoxId** - идентификатор ящика отправителя документов, созданных на основе шаблонов
* **MessageToBoxId** - идентификатор ящика получателя документов, созданных на основе шаблонов
* **MessageToDepartmentId** - идентификатор подразделения получателя сообщения, которое будет создано на основе отправляемого шаблона
* **LockMode** - режим блокировки сообщения с шаблонами, доступны значения:

    * *None* - блокировка не производится
    * *Send* - для документов пакета возможна только совместная отправка. Свойства залоченности работают по аналогии с закрытыми пакетами (режимом Full) и сохраняются до отправки пакета. После отправки пакета документов все ограничения на подокументную обработку снимаются.
    * *Full* - документы сообщения будут отправлены закрытым пакетом. В таком пакете любая операция применяется ко всем документам сразу.

Структура **Отправитель / Получатель**:

    * **BoxId** - идентификатор ящика отправителя/получателя пакета на сервере Диадока
    * **ОрганизацияЭДО** - ссылка на организацию / контрагента в 1С
    * **Организация** - ссылка на сопоставленную организацию / контрагента в базе 1С
    * **FNSParticipantId** - ФНС идентификатор участника электронного документоооборота
    * **DepartmentId** - идентификатор подразделения участника электронного документоооборота

Структура **СлужебнаяИнформация**:

    * **ОтложеннаяОтправка** - признак того, что пакет сохранен на сервере Диадока без отправки контрагенту
    * **ЗашифрованныйПакет** - признак того, что пакет содержит зашифрованные документы


.. _Пакет_до_4.0:

Пакет (до версии 4.0)
---------------------

Пакет - структура, содержащая сведения о пакете документов. Создание пустой структуры происходит в функции основного модуля ЭДО_ПакетДокументовМенеджер_СоздатьНовый().

*Элементы:*

* **Данные1С** (тип Структура) - структура Свойства1С, содержащая общие поля из 1С для всех документов пакета.
*	**Документы** (тип Массив) - массив структур для хранения сведений о каждом документе пакета: описание контента, тип документа, ссылка на документ в 1С и т.п.
* **ДополнительныеРеквизиты** (тип Структура) - структура дополнительных данных любого типа, которые могут быть использованы в событие ПодготовкиПакета и после. Допустимо использование не более 5 реквизитов.

Структура **Свойства1С**:

* **Организация** - ссылка на организацию в 1С, от лица которой сформирован пакет.
* **Контрагент** - ссылка на контрагента в 1С, которому предназначен пакет.
* **ПодразделениеОрганизации** - ссылка на организацию в 1С, являющуюся обособленным подразделением головной организации, от лица которой сформирован пакет.
* **ПодразделениеКонтрагента** - ссылка на подразделение контрагента в 1С, которому предназначен пакет.
* **ЭтоВнутреннийДокумент** - признак пакета с внутренними документами.
* **Ссылка** - ссылка на пакет в 1С.
* **ВидПакета** - ссылка на вид пакета в 1С.
* **ВидПакетаID** - внутренний идентификатор вида пакета.
* **Документ** - ссылка на документ в 1С, который является основным для данного пакета.
* **НомерДокумента** - номер документа в 1С.
* **ДатаДокумента** - дата документа в 1С.
* **СуммаДокумента** - сумма документа в 1С.
* **ПереотправляемыйПакетСсылка** - ссылка на переотправляемый пакет в 1С.
* **ПараметрыШаблона** - содержит поля:

    * **MessageFromBoxId** - идентификатор ящика отправителя документов, созданных на основе шаблонов.
    * **MessageToBoxId** - идентификатор ящика получателя документов, созданных на основе шаблонов.
    * **MessageToDepartmentId** - идентификатор подразделения получателя сообщения, которое будет создано на основе отправляемого шаблона.
    * **LockMode** - режим блокировки сообщения с шаблонами, доступны значения:

        * *None* - блокировка не производится
        * *Send* - для документов пакета возможна только совместная отправка. Свойства залоченности работают по аналогии с закрытыми пакетами (режимом Full) и сохраняются до отправки пакета. После отправки пакета документов все ограничения на подокументную обработку снимаются.
        * *Full* - документы сообщения будут отправлены закрытым пакетом. В таком пакете любая операция применяется ко всем документам сразу.
